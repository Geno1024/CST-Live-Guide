\section{进位制的表示与转换}\label{sec:ArithBasics/positional-notation-presentation-and-conversion}
    同一个数在不同的进位制中会有不同的表现形式，于是出现了不同进位制之间的表示与转换的问题。
    \subsection{进位制的表示}\label{subsec:ArithBasics/positional-notation-presentation-and-conversion/presentation}
        在数学上，记号通常由发明记号的数学家的想象力与其所学习的语言数量决定；而在计算机相关的方面，记号通常会受到输入输出的设备与系统的限制，因此数学和计算机（编程）方面的表示会有所不同。
        \begin{itemize}
            \item 数学上较为常见的记号是，将数直接写出，然后将底数作为下标附在其后。例如，二进制的 $1010$ 记为\[1010_2\]。有的记号则将数或基数使用小括号包裹，例如\[1010_{(2)}\]或\[(1010)_2\]，这些都是常见的数学上的进位制记号。
            \item 计算机方面，在不同的场合与不同的程序语言中有不同的记号，并且大多数仅指定了记录十进制、十六进制和八进制的记号，少数指定了二进制的记号，少见可以指定任意进制的记号。最为常见的记号来自 C 语言，指定了十六进制前缀 \texttt{0x} 和八进制前缀 \texttt{0}，另外还有见于颜色表示的十六进制前缀 \texttt{\#}，见于 HTML 编码的 \texttt{x} 等。有时需要根据上下文才能判断具体的进制。
        \end{itemize}
    \subsection{不同进位制的转换}\label{subsec:ArithBasics/positional-notation-presentation-and-conversion/conversion}
        根据进位制的原理，我们可以计算出一个（我们所熟悉的）十进制数所对应的其他进制的表示，也可以将一个其他进制的表示转换为十进制。这样，借助我们所熟悉的十进制，我们就能做到任意进制的相互转换。若源进制与目标进制的基数在分解质因数后有一定的关系，或者非常熟悉目标进制的运算的话，我们也可以不借助十进制直接进行不同进位制的转换。

        \subsubsection{十进制转换为其他进制}\label{subsubsec:ArithBasics/positional-notation-presentation-and-conversion/conversion/from-decimal}
            将一个十进制数转换为其他进制有几种方法。整数部分可以使用短除法或者退位法，小数部分可以使用连乘法或者退位法，然后将两部分合起来即可。
            \begin{enumerate}
                \item 整数的短除法

                    首先，将这个十进制数除以目标进制的以十进制表示的基底，记录该除法结果的余数在目标进制下的表示，并将商继续进行这种除法，直到商为 0 为止，然后将记录的余数从最后到最开始的顺序书写，即为该数的目标进制的表示。

                    例如，欲将十进制整数 $13579$ 转换为十六进制：

                    \begin{enumerate}
                        \item 将该十进制整数除以目标进制的以十进制表示的基底（即 $16$），得到商 $848$，余数 $11$ 转换为目标进制的结果为 $B$；
                        \item 商 $848$ 继续除以 $16$ 得到商 $53$，余数 $0$（整除）；
                        \item $53$ 除以 $16$ 得到商 $3$，余数 $5$；
                        \item $3$ 除以 $16$ 得到商 $0$，余数 $3$，短除法结束；
                        \item 将计算得到的余数从下往上读取一遍，即得到结果 $(350B)_{16}$。
                    \end{enumerate}

                    % https://tex.stackexchange.com/a/210652/149813
                    \begin{figure}
                        \centering
                        \begin{tabular}{rrlll}
                            16 \shortdiv{13579} &    &                 &   &                        \\
                            16   \shortdiv{848} & 11 & \textrightarrow & B & \tikzmark{sdi-end}     \\
                            16    \shortdiv{53} &  0 & \textrightarrow & 0 &                        \\
                            16     \shortdiv{3} &  5 & \textrightarrow & 5 &                        \\
                            0                   &  3 & \textrightarrow & 3 & \tikzmark{sdi-start}
                        \end{tabular}
                        \begin{tikzpicture}[overlay, remember picture]
                            \draw[->] ($(pic cs:sdi-start)+(0pt,.5ex)$) to ($(pic cs:sdi-end)+(0pt,.5ex)$);
                        \end{tikzpicture}
                        \caption{短除法转换十进制整数为其他进制的示例}
                        \label{fig:ArithBasics/positional-notation-presentation-and-conversion/conversion/from-decimal/short-division-integer}
                    \end{figure}
                \item 整数的退位法

                    将目标进制的的基底的乘方序列以十进制表示从 $1$ 开始往左写，直到比这个十进制数大为止。然后将这一行数从左向右依次与这个数比较，如果这个十进制数比较大的话，就将这个十进制数减去对应的数若干次直到比对应的数小，并且在其下方写上减去的次数在目标进制下的表示，否则就跳过并在其下方写上 $0$，直到这个数被减到 $0$ 为止，如果这一行数还未结束的话则在剩下的数下方均写上 $0$，以此得到的第二行数即为该数的目标进制的表示。

                    例如，欲将十进制整数 $3096$ 转换为八进制：

                    \begin{enumerate}
                        \item 将目标进制的基底的乘方序列以十进制表示从 $1$ 开始往左写，直到比这个十进制数大为止，得到数列 $4096$、$512$、$64$、$8$、$1$；
                        \item 然后将这一行数从左向右依次与这个数比较，第一个是 $4096$，比 $3072$ 大，故在 $4096$ 下方写 $0$；
                        \item 下一个数是 $512$，比 $3096$ 小，尝试发现减去 $6$ 次之后的结果 $24$ 开始比 $512$ 小，故在 $512$ 下方写 $6$；
                        \item 下一个数 $64$ 比 $24$ 大，故跳过，在 $64$ 下方写 $0$；
                        \item 下一个数 $8$ 可以将 $24$ 减去 $3$ 次得到 $0$，故在 $8$ 下方写 $3$，并结束循环；
                        \item 最后剩余一个数 $1$，在其下方写上 $0$；
                        \item 将第二行数从左向右读取，并舍弃开头的 $0$，即得到结果 $(6030)_8$。
                    \end{enumerate}

                    \begin{figure}
                        \centering
                        \begin{tabular}{lrrrrr}
                            乘方序列     & 4096 &  512 & 64 &  8 & 1 \\
                            结果         & 0    &    6 &  0 &  3 & 0 \\ \hline
                            要减去多少   & 0    & 3072 &  0 & 24 &   \\
                            剩余         & 3096 &   24 & 24 &  0 &
                        \end{tabular}
                        \caption{退位法转换十进制整数为其他进制的示例}
                        \label{fig:ArithBasics/positional-notation-presentation-and-conversion/conversion/from-decimal/descending-subtraction-integer}
                    \end{figure}
                \item 小数的连乘法

                    将小数部分乘以目标进制的以十进制表示的基底，记录该乘法结果的整数部分在目标进制下的表示，并将小数部分继续进行这种乘法，直到小数部分为 0 为止，然后将记录的整数部分从最开始到最后的顺序书写，即为该数的目标进制的表示。

                    注意，将小数进行进制转换时，很容易出现“死循环”，即永远无法达到“小数部分为 0”的情况。这是非常常见的情况，此时转换的结果会是一个无限循环小数或者无限不循环小数，就像 $\frac{1}{3}$ 在十进制下表示为无限循环小数 $0.\overline{3}$ 而在三进制下简单地表示为 $0.1$ 一样。

                    例如，欲将十进制小数 $0.3125$ 转换为二进制：
                    \begin{enumerate}
                        \item 将小数部分乘以目标禁止的以十进制表示的基底（即 $2$），得到 $0.625$，整数部分为 $0$，小数部分为 $.625$；
                        \item 小数部分 $.625$ 继续乘以 $2$ 得到 $1.25$，整数部分为 $1$，小数部分为 $.25$；
                        \item $.25$ 乘以 $2$ 得到 $0.5$，整数部分为 $0$，小数部分为 $.5$；
                        \item $.5$ 乘以 $2$ 得到 $1$，整数部分为 $1$，小数部分为 $.$，连乘法结束；
                        \item 将计算得到的整数部分从上往下读取一遍，即得到结果 $(0.0101)_2$。
                    \end{enumerate}

                    \begin{figure}
                        \centering
                        \begin{tabular}{llll}
                            \tikzmark{lmf-start}    &   &          & .3125 \\
                                                    &   & $\times$ &     2 \\ \hline
                                                    & 0 &          & .625  \\
                                                    &   & $\times$ &    2  \\ \hline
                                                    & 1 &          & .25   \\
                                                    &   & $\times$ &   2   \\ \hline
                                                    & 0 &          & .5    \\
                                                    &   & $\times$ &  2    \\ \hline
                            \tikzmark{lmf-end}      & 1 &          & .
                        \end{tabular}
                        \begin{tikzpicture}[overlay, remember picture]
                            \draw[->] ($(pic cs:lmf-start)+(0pt,.5ex)$) to ($(pic cs:lmf-end)+(0pt,.5ex)$);
                        \end{tikzpicture}
                        \caption{连乘法转换十进制小数为其他进制的示例}
                        \label{fig:ArithBasics/positional-notation-presentation-and-conversion/conversion/from-decimal/long-multiplication-fractal}
                    \end{figure}

                \item 小数的退位法

                    与整数的退位法类似，但是所需要的乘方序列的指数是负数的数列。

                    例如，欲将十进制小数 $0.57421875$ 转换为十六进制：

                    \begin{enumerate}
                        \item 将目标进制的基底的负数乘方序列以十进制表示从 $1$ 开始往右写，由于无法事先知道有多少位因此先写一位，得到数列 $1$、$0.0625$；
                        \item 然后从 $1$ 的下一个数开始，试着减去足够多次的 $0.0625$ 但不变成负数，将能够减去的最大次数 $9$ 写于其下方，并记录减去之后的剩余 $0.01171875$；
                        \item 再计算一位乘方序列也就是 $16^{-2}$，得到 $0.00390625$；
                        \item 将刚刚的剩余 $0.01171875$ 做如上的试减，将能够减去的最大次数 $3$ 写于其下方，减去之后的剩余为 $0$，故结束循环；
                        \item 将第二行数从左向右读取，并补上开头的 $0.$，即得到结果 $(0.93)_{16}$。
                    \end{enumerate}

                    \begin{figure}
                        \centering
                        \begin{tabular}{llll}
                            乘方序列   & 1          & 0.0625     & 0.00390625 \\
                            结果       & 0          &          9 &          3 \\ \hline
                            要减去多少 & 0          & 0.5625     & 0.01171875 \\
                            剩余       & 0.57421875 & 0.01171875 & 0
                        \end{tabular}
                        \caption{退位法转换十进制为其他进制的示例}
                        \label{fig:ArithBasics/positional-notation-presentation-and-conversion/conversion/from-decimal/descending-subtraction-fractal}
                    \end{figure}
            \end{enumerate}
        \subsubsection{其他进制转换为十进制}\label{subsubsec:ArithBasics/positional-notation-presentation-and-conversion/conversion/to-decimal}
            将一个非十进制的数转换为十进制，只需要将各位上的数与对应位的权重相乘并求和即可。

            例如将十六进制数 $(BAD.BEEF)_{16}$ 转换为十进制：
            \begin{enumerate}
                \item 将原数的每一位都转为十进制；
                \item 从小数点开始，往上是源基底的 $0$ 次方并将指数递增，往下是源基底的 $-1$ 次方并将指数递减，写出每一位的权重；
                \item 每一位均乘以对应的权重，得到积；
                \item 将积求和，即得到结果 $2989.7458343505859375$。
            \end{enumerate}

            \begin{figure}
                \centering
                \begin{tabular}{r|lrrlrl}
                    原数 &             十进制 &          &      权重 &   &  积 \\
                    B    & \textrightarrow 11 & $\times$ & $16^2$    & = & 2816 &. \\
                    A    & \textrightarrow 10 & $\times$ & $16^1$    & = &  160 &. \\
                    D    & \textrightarrow 13 & $\times$ & $16^0$    & = &   13 &. \\
                    .    & \textrightarrow  . & $\times$ &  .        & = &      &. \\
                    B    & \textrightarrow 11 & $\times$ & $16^{-1}$ & = &    0 &.6875 \\
                    E    & \textrightarrow 14 & $\times$ & $16^{-2}$ & = &    0 &.0546875 \\
                    E    & \textrightarrow 14 & $\times$ & $16^{-3}$ & = &    0 &.00341796875 \\
                    F    & \textrightarrow 14 & $\times$ & $16^{-4}$ & = &    0 &.0002288818359375 \\
                        &                     &          &           & + &                      \\ \hline
                        &                     &          &           &   & 2989 &.7458343505859375
                \end{tabular}
                \caption{转换十六进制数为十进制数的示例}
                \label{fig:ArithBasics/positional-notation-presentation-and-conversion/conversion/to-decimal/positional}
            \end{figure}
